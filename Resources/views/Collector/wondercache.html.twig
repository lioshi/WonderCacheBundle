{% extends 'WebProfilerBundle:Profiler:layout.html.twig' %}
 
{% block toolbar %}
    {% set icon %}
        
        {% if collector.nbrlogsinvalidations > 0 %} <img width="20" height="28" alt="API" src="data:image/png;base64,{{ collector.iconbase64('invalidations') }}" />
        {% elseif  collector.nbrlogswarnings > 0 %} <img width="20" height="28" alt="API" src="data:image/png;base64,{{ collector.iconbase64('warnings') }}" />
        {% elseif     collector.nbrlogsinfos > 0 %} <img width="20" height="28" alt="API" src="data:image/png;base64,{{ collector.iconbase64('infos') }}" />
        {% endif %}

        <span class="sf-toolbar-info-piece-additional-detail">Wonder cache</span>

    {% endset %}

    {% set text %}
        {% if collector.nbrlogsinfos > 0 %}
            <div class="sf-toolbar-info-piece">
                <b>Infos</b>
                <span class="sf-toolbar-status sf-toolbar-status-green">{{ collector.nbrlogsinfos }}</span>
            </div>
        {% endif %}
        {% if collector.nbrlogswarnings > 0 %}
            <div class="sf-toolbar-info-piece">
                <b>Warnings</b>
                <span class="sf-toolbar-status sf-toolbar-status-yellow">{{ collector.nbrlogswarnings }}</span>
            </div>
        {% endif %}
        {% if collector.nbrlogsinvalidations > 0 %}
            <div class="sf-toolbar-info-piece">
                <b>Invalidations</b>
                <span class="sf-toolbar-status sf-toolbar-status-red">{{ collector.nbrlogsinvalidations }}</span>
            </div>
        {% endif %}
    {% endset %}
    {% include 'WebProfilerBundle:Profiler:toolbar_item.html.twig' with { 'link': profiler_url } %}

{% endblock %}
 
 
{% block menu %}

<span class="label">
    <span class="icon">
      <img width="20" height="28" alt="API" src="data:image/png;base64,{{ collector.iconbase64 }}" />
    </span>
    <strong>WonderCache</strong>
    <span class="count">
        <span>{{ collector.nbrlogs }}</span>
        <span>666 ms</span>
    </span>
</span>

{% endblock %}
 
{% block panel %}

    {% if not collector.nbrlogs %}
        <p>
            <em>No log.</em>
        </p>
    {% else %}
        <h2>Infos</h2>
        {% if not collector.nbrlogsinfos %}
            <p>
                <em>No info.</em>
            </p>
        {% else %}
            <ul class="alt">
                {% for i, info in collector.logsinfos %}
                    <li class="{{ i is even ? 'odd' : 'even' }}">
                        <div>
                            {{ info.log }}<br />
                         </div>
                    </li>
                    <li class="{{ i is even ? 'odd' : 'even' }}">
                        {% if info.entities|length %}
                            <table>
                                <thead>
                                    <tr>
                                        <th scope="col">Entity</th>
                                        <th scope="col">Ids</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for entity, ids in info.entities %}
                                        <tr>
                                            <th>{{ entity }}  </th>
                                            <td>
                                                {% if ids|length %}
                                                    [{{ ids|join(',') }}]
                                                {% else %}
                                                    all
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <h2>Warnings</h2>
        {% if not collector.nbrlogswarnings %}
            <p>
                <em>No warning.</em>
            </p>
        {% else %}
            <ul class="alt">
                {% for i, log in collector.logswarnings %}
                    <li class="{{ i is even ? 'odd' : 'even' }}">
                        <div>
                            {{ log }}<br />
                         </div>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <h2>Invalidations</h2>
        {% if not collector.nbrlogsinvalidations %}
            <p>
                <em>No invalidation.</em>
            </p>
        {% else %}
            <ul class="alt">
                {% for i, log in collector.logsinvalidations %}
                    <li class="{{ i is even ? 'odd' : 'even' }}">
                        <div>
                            {{ log }}<br />
                         </div>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endif %}

{% endblock %}
